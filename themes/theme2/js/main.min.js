function formatTimestampToDateTime(timestamp,format){var timeObj={M:timestamp.getMonth()+1,d:timestamp.getDate(),h:timestamp.getHours(),m:timestamp.getMinutes(),s:timestamp.getSeconds(),q:Math.floor((timestamp.getMonth()+3)/3),S:timestamp.getMilliseconds()};for(var key in/(y+)/.test(format)&&(format=format.replace(RegExp.$1,(timestamp.getFullYear()+"").substr(4-RegExp.$1.length))),timeObj)if(new RegExp("("+key+"+)").test(format)){var value="";value=1==RegExp.$1.length?timeObj[key]:("00"+timeObj[key]).substr((""+timeObj[key]).length),format=format.replace(RegExp.$1,value)}return format}function GetRandomNum(Min,Max){var Range=Max-Min,Rand=Math.random();return Min+Math.round(Rand*Range)}function formatBlance(balance){var str=balance.toString().split("."),a=str[0],b=str[1];return a&&(a=parseInt(a)),b=b?"."+b:"",a.toLocaleString()+b}function playAudio(strArr){var audiofile="",getArr=strArr.split(","),type,lang,audio;if("Netscape"==navigator.appName)var lang=navigator.language;else var lang=navigator.userLanguage;switch(lang=lang.substr(0,2)){default:case"en":audiofile="en/1/"+getArr[GetRandomNum(0,getArr.length-1)]}new Audio(theme_path+"audio/"+audiofile+".m4a").play()}var audioFlag=1,audioblockTime=0,audioListtransactionsIndex=0;function get_wallet_info(){$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_wallet_info"},success:function(data){if(data.s){var obj=data;$(".balance").text(formatBlance(obj.balance)),$(".connections").text(obj.connections),$(".chain").text(obj.chain),obj.connections>=1?obj.generate?($(".status").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Mining...'),1!=audioFlag&&(audioFlag=1,playAudio("3"))):($(".status").html('<span class="spinner-border spinner-border-sm text-success" role="status" aria-hidden="true"></span>&nbsp;Synchronizing...'),2!=audioFlag&&(audioFlag=2,playAudio("2"))):($(".status").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Connecting...'),3!=audioFlag&&(audioFlag=3,playAudio("1")));var listsinceblock=obj.listsinceblock.transactions,immaturebalance=0;$.each(listsinceblock,(function(index){"immature"==listsinceblock[index].category&&(immaturebalance+=listsinceblock[index].amount)})),$(".unconfirmedbalance").text(formatBlance(obj.unconfirmedbalance+immaturebalance)),$(".accounts").html("");var listaccounts=obj.listaccounts;$.each(listaccounts,(function(key,value){$(".accounts").append("<tr><td>"+(""==key?"default":key)+'</td><td class="amount">'+formatBlance(value)+" "+symbol+"</td></tr>")})),$(".transactions").html("");var listtransactions=obj.listtransactions;$.each(listtransactions,(function(index){if(1==listtransactions[index].generated)var categoryImg="img/icon/tx_mined.png";else switch(listtransactions[index].category){case"send":var categoryImg="img/icon/tx_output.png";break;case"receive":var categoryImg="img/icon/tx_input.png";break;case"move":default:var categoryImg="img/icon/tx_inout.png"}if("receive"==listtransactions[index].category)switch(!0){case listtransactions[index].confirmations>=6:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=5:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=4:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=3:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=2:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}else switch(!0){case listtransactions[index].confirmations>=100:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=80:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=60:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=40:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=20:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}var amount=listtransactions[index].amount;if(amount>0)var amountClass="",amountSymbol="+";else var amountClass="negative",amountSymbol="";var td_account_address="";td_account_address="move"==listtransactions[index].category?'<span style="color:blue;">'+(""==listtransactions[index].account?"default":listtransactions[index].account)+"</span><br>"+(""==listtransactions[index].otheraccount?"default":listtransactions[index].otheraccount):'<span style="color:blue;">'+(""==listtransactions[index].account?"default":listtransactions[index].account)+"</span><br>"+listtransactions[index].address,$(".transactions").prepend('<tr><td><img src="'+theme_path+categoryImg+'" width="36" height="36" /></td><td style="text-align:left;">'+td_account_address+"</td><td>"+formatTimestampToDateTime(new Date(1e3*listtransactions[index].time),"yyyy-MM-dd hh:mm:ss")+"</td><td>"+(listtransactions[index].confirmations?'<img src="'+theme_path+confirmationsImg+'" width="24" height="24" />('+listtransactions[index].confirmations+")":'<img src="'+theme_path+'img/icon/transaction2.png" width="24" height="24" />')+'</td><td class="amount"><span class="'+amountClass+'">'+amountSymbol+formatBlance(amount)+"</span> "+symbol+"</td></tr>"),audioListtransactionsIndex=index})),audioblockTime?audioblockTime!=listtransactions[audioListtransactionsIndex].time&&(audioblockTime=listtransactions[audioListtransactionsIndex].time,1==listtransactions[audioListtransactionsIndex].generated?playAudio("4,5,6"):listtransactions[audioListtransactionsIndex].amount>0&&playAudio("7,8")):audioblockTime=listtransactions[audioListtransactionsIndex]?listtransactions[audioListtransactionsIndex].time:0}else $(".status").text(data.e)},error:function(XMLHttpRequest,textStatus,errorThrown){$(".status").text(textStatus)},complete:function(XMLHttpRequest,textStatus){}})}function get_history(){$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_history"},success:function(data){if(data.s){var listtransactions=data.listsinceblock.transactions;listtransactions.sort((function(a,b){return a.time-b.time})),$(".transactions").html(""),$.each(listtransactions,(function(index){if(1==listtransactions[index].generated)var categoryImg="img/icon/tx_mined.png";else switch(listtransactions[index].category){case"send":var categoryImg="img/icon/tx_output.png";break;case"receive":var categoryImg="img/icon/tx_input.png";break;default:var categoryImg="img/icon/tx_inout.png"}if("receive"==listtransactions[index].category)switch(!0){case listtransactions[index].confirmations>=6:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=5:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=4:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=3:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=2:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}else switch(!0){case listtransactions[index].confirmations>=100:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=80:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=60:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=40:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=20:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}var amount=listtransactions[index].amount;if(amount>0)var amountClass="",amountSymbol="+";else var amountClass="negative",amountSymbol="";$(".transactions").prepend("<tr><td>"+(index+1)+'</td><td><img src="'+theme_path+categoryImg+'" width="36" height="36" /></td><td style="text-align:left;"><span style="color:blue;">'+(""==listtransactions[index].account?"default":listtransactions[index].account)+"</span><br>"+listtransactions[index].address+"</td><td>"+formatTimestampToDateTime(new Date(1e3*listtransactions[index].time),"yyyy-MM-dd hh:mm:ss")+'</td><td><img src="'+theme_path+confirmationsImg+'" width="24" height="24" />('+listtransactions[index].confirmations+')</td><td class="amount"><span class="'+amountClass+'">'+amountSymbol+formatBlance(amount)+"</span> "+symbol+"</td></tr>")}))}else $(".status").text(data.e)},error:function(XMLHttpRequest,textStatus,errorThrown){$(".status").text(textStatus)},complete:function(XMLHttpRequest,textStatus){}})}function get_receive(){$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_receive"},success:function(data){if(data.s){var listtransactions=data.listsinceblock.transactions;listtransactions.sort((function(a,b){return a.time-b.time})),$(".transactions").html(""),$.each(listtransactions,(function(index){if("receive"==listtransactions[index].category){switch(!0){case listtransactions[index].confirmations>=6:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=5:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=4:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=3:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=2:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}var amount=listtransactions[index].amount;if(amount>0)var amountClass="",amountSymbol="+";else var amountClass="negative",amountSymbol="";$(".transactions").prepend("<tr><td>"+(index+1)+'</td><td style="text-align:left;"><span style="color:blue;">'+(""==listtransactions[index].account?"default":listtransactions[index].account)+"</span><br>"+listtransactions[index].address+"</td><td>"+formatTimestampToDateTime(new Date(1e3*listtransactions[index].time),"yyyy-MM-dd hh:mm:ss")+'</td><td><img src="'+theme_path+confirmationsImg+'" width="24" height="24" />('+listtransactions[index].confirmations+')</td><td class="amount"><span class="'+amountClass+'">'+amountSymbol+formatBlance(amount)+"</span> "+symbol+"</td></tr>")}}))}else $(".status").text(data.e)},error:function(XMLHttpRequest,textStatus,errorThrown){$(".status").text(textStatus)},complete:function(XMLHttpRequest,textStatus){}})}function get_address(){$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_address"},success:function(data){data.s?($(".transactions").html(""),$.each(data.getaddressesbyaccount_list,(function(key,arr){$.each(arr,(function(index,value){$(".transactions").append("<tr><td>"+(index+1)+'</td><td style="text-align:left;"><span style="color:blue;">'+(""==key?"default":key)+'</span></td><td style="text-align:left;">'+value+"</td></tr>")}))}))):$(".status").text(data.e)},error:function(XMLHttpRequest,textStatus,errorThrown){$(".status").text(textStatus)},complete:function(XMLHttpRequest,textStatus){}})}function get_send(){$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_send"},success:function(data){if(data.s){var listtransactions=data.listsinceblock.transactions;listtransactions.sort((function(a,b){return a.time-b.time})),$(".transactions").html(""),$.each(listtransactions,(function(index){if("send"==listtransactions[index].category){switch(!0){case listtransactions[index].confirmations>=6:var confirmationsImg="img/icon/transaction2.png";break;case listtransactions[index].confirmations>=5:var confirmationsImg="img/icon/clock5.png";break;case listtransactions[index].confirmations>=4:var confirmationsImg="img/icon/clock4.png";break;case listtransactions[index].confirmations>=3:var confirmationsImg="img/icon/clock3.png";break;case listtransactions[index].confirmations>=2:var confirmationsImg="img/icon/clock2.png";break;default:var confirmationsImg="img/icon/clock1.png"}var amount=listtransactions[index].amount;if(amount>0)var amountClass="",amountSymbol="+";else var amountClass="negative",amountSymbol="";$(".transactions").prepend("<tr><td>"+(index+1)+'</td><td class="text-left">'+(null==listtransactions[index].address?"":listtransactions[index].address)+'<br>txid:<a href="'+explore_url_tx+listtransactions[index].txid+'" target="_blank">'+listtransactions[index].txid+"</a></td><td>"+formatTimestampToDateTime(new Date(1e3*listtransactions[index].time),"yyyy-MM-dd hh:mm:ss")+'</td><td><img src="'+theme_path+confirmationsImg+'" width="24" height="24" />('+listtransactions[index].confirmations+')</td><td class="amount"><span class="'+amountClass+'">'+amountSymbol+formatBlance(amount)+"</span> "+symbol+"</td></tr>")}}))}else $(".status").text(data.e)},error:function(XMLHttpRequest,textStatus,errorThrown){$(".status").text(textStatus)},complete:function(XMLHttpRequest,textStatus){}})}function send_to_address(element){var btn=$(element),btn_text=btn.text();if(btn.attr("disabled",!0),btn.html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>&nbsp;Loading...'),$("#sendtxid").css("display",""),!$("#address")[0].value||!$("#amount")[0].value)return $("#sendtxid").append('<div class="alert alert-danger" role="alert">error: empty</div>'),btn.text(btn_text),void btn.attr("disabled",!1);$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"send_to_address",address:$("#address")[0].value,amount:$("#amount")[0].value,sffa:$("#subtract_fee_from_amount").prop("checked")?1:0},success:function(data){data.s?($("#sendtxid").append('<div class="alert alert-success" role="alert">'+data.sendtxid+"</div>"),playAudio("9,10")):$("#sendtxid").append('<div class="alert alert-danger" role="alert">'+data.e+"</div>")},error:function(XMLHttpRequest,textStatus,errorThrown){$("#sendtxid").append('<div class="alert alert-danger" role="alert">'+textStatus+"</div>")},complete:function(XMLHttpRequest,textStatus){btn.text(btn_text),btn.attr("disabled",!1)}})}function send_to_address_direct(address,amount_min,amount_max){if(address&&amount_min&&amount_max){if(amount_min>amount_max){var t=amount_max;amount_max=amount_min,amount_min=t}var amount=Math.floor(Math.random()*amount_max+amount_min);$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"send_to_address",address:address,amount:amount},success:function(data){data.s||console.log(data)},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(XMLHttpRequest),console.log(textStatus),console.log(errorThrown)},complete:function(XMLHttpRequest,textStatus){}})}}function send_many(element){var btn=$(element),btn_text=btn.text();if(btn.attr("disabled",!0),btn.html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>&nbsp;Loading...'),$("#sendtxid").css("display",""),!$("#send_many_address_amount")[0].value)return $("#sendtxid").append('<div class="alert alert-danger" role="alert">error: empty</div>'),btn.text(btn_text),void btn.attr("disabled",!1);var obj={},flag=!0;$.each($("#send_many_address_amount")[0].value.split("\n"),(function(index,value){var arr=value.trim().split(":");if(!(arr.length>=2))return $("#sendtxid").append('<div class="alert alert-danger" role="alert">error: format invalid</div>'),btn.text(btn_text),btn.attr("disabled",!1),void(flag=!1);obj[arr[0].trim()+""]=1*arr[1].trim()})),flag&&$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"send_many",address_amount:JSON.stringify(obj),sffa:$("#send_many_subtract_fee_from_amount").prop("checked")?1:0},success:function(data){data.s?($("#sendtxid").append('<div class="alert alert-success" role="alert">'+data.sendtxid+"</div>"),playAudio("9,10")):$("#sendtxid").append('<div class="alert alert-danger" role="alert">'+data.e+"</div>")},error:function(XMLHttpRequest,textStatus,errorThrown){$("#sendtxid").append('<div class="alert alert-danger" role="alert">'+textStatus+"</div>")},complete:function(XMLHttpRequest,textStatus){btn.text(btn_text),btn.attr("disabled",!1)}})}function send_many_direct(str){if(str){var obj={};$.each(str.trim().split("\n"),(function(index,value){var arr=value.trim().split(":");obj[arr[0].trim()+""]=1*arr[1].trim()})),$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"send_many",address_amount:JSON.stringify(obj)},success:function(data){data.s||console.log(data)},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(XMLHttpRequest,textStatus),console.log(errorThrown)},complete:function(XMLHttpRequest,textStatus){}})}}function get_new_address(custom_prefix,str){$("#newaddress_status").html('<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>&nbsp;Loading...'),$("#newaddress_status").css("display",""),$("#newaddress_status").removeClass().addClass("alert alert-info");var address_prefix="",round=0;if(custom_prefix&&(address_prefix="N"+$("#address").val(),(round=$("#round").val())<=0))return $("#newaddress_status").text("Round is 0, End"),void $("#newaddress_status").removeClass().addClass("alert alert-info");$.ajax({url:ajax_url,type:"post",dataType:"json",data:{action:"get_new_address"},success:function(data){if(data.s)if(custom_prefix){var amount_min=1,amount_max=10,amount=Math.floor(10*Math.random()+1),fetched_address_prefix;str+=data.getnewaddress+":"+amount+"\n",data.getnewaddress.substr(0,address_prefix.length)==address_prefix?($("#newaddress").css("display",""),$("#newaddress").append(data.getnewaddress+"<br>"),$("#newaddress").removeClass().addClass("alert alert-success")):$("#newaddress_status").text(data.getnewaddress),round>=500&&round%500==0&&(send_many_direct(str),str=""),--round>0?($("#round").val(round),setTimeout(()=>{get_new_address(custom_prefix,str)},10)):($("#newaddress_status").text("Round End"),$("#newaddress_status").removeClass().addClass("alert alert-info"),send_many_direct(str))}else $("#newaddress").css("display",""),$("#newaddress").append(data.getnewaddress+"<br>"),$("#newaddress").removeClass().addClass("alert alert-success"),$("#newaddress_status").text(""),$("#newaddress_status").css("display","none");else $("#newaddress_status").text(data.e),$("#newaddress_status").removeClass().addClass("alert alert-danger")},error:function(XMLHttpRequest,textStatus,errorThrown){$("#newaddress_status").html(textStatus),$("#newaddress_status").removeClass().addClass("alert alert-danger")},complete:function(XMLHttpRequest,textStatus){}})}